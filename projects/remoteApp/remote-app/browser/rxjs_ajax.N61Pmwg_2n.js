import{__assign as Y}from"tslib";function y(r){return typeof r=="function"}function Dr(r){return y(r?.lift)}function ur(r){return function(e){if(Dr(e))return e.lift(function(t){try{return r(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}import{__extends as Ir}from"tslib";import{__extends as Er}from"tslib";import{__read as sr,__spreadArray as cr,__values as fr}from"tslib";function O(r){var e=function(n){Error.call(n),n.stack=new Error().stack},t=r(e);return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var U=O(function(r){return function(t){r(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(n,o){return o+1+") "+n.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t}});function N(r,e){if(r){var t=r.indexOf(e);0<=t&&r.splice(t,1)}}var L=function(){function r(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return r.prototype.unsubscribe=function(){var e,t,n,o,i;if(!this.closed){this.closed=!0;var u=this._parentage;if(u)if(this._parentage=null,Array.isArray(u))try{for(var s=fr(u),a=s.next();!a.done;a=s.next()){var h=a.value;h.remove(this)}}catch(v){e={error:v}}finally{try{a&&!a.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}else u.remove(this);var b=this.initialTeardown;if(y(b))try{b()}catch(v){i=v instanceof U?v.errors:[v]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var m=fr(d),w=m.next();!w.done;w=m.next()){var q=w.value;try{pr(q)}catch(v){i=i??[],v instanceof U?i=cr(cr([],sr(i)),sr(v.errors)):i.push(v)}}}catch(v){n={error:v}}finally{try{w&&!w.done&&(o=m.return)&&o.call(m)}finally{if(n)throw n.error}}}if(i)throw new U(i)}},r.prototype.add=function(e){var t;if(e&&e!==this)if(this.closed)pr(e);else{if(e instanceof r){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}},r.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},r.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},r.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&N(t,e)},r.prototype.remove=function(e){var t=this._finalizers;t&&N(t,e),e instanceof r&&e._removeParent(this)},r.EMPTY=function(){var e=new r;return e.closed=!0,e}(),r}();var ye=L.EMPTY;function H(r){return r instanceof L||r&&"closed"in r&&y(r.remove)&&y(r.add)&&y(r.unsubscribe)}function pr(r){y(r)?r():r.unsubscribe()}var T={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};import{__read as lr,__spreadArray as dr}from"tslib";var j={setTimeout:function(r,e){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];var o=j.delegate;return o?.setTimeout?o.setTimeout.apply(o,dr([r,e],lr(t))):setTimeout.apply(void 0,dr([r,e],lr(t)))},clearTimeout:function(r){var e=j.delegate;return(e?.clearTimeout||clearTimeout)(r)},delegate:void 0};function hr(r){j.setTimeout(function(){var e=T.onUnhandledError;if(e)e(r);else throw r})}function M(){}var mr=function(){return X("C",void 0,void 0)}();function vr(r){return X("E",void 0,r)}function yr(r){return X("N",r,void 0)}function X(r,e,t){return{kind:r,value:e,error:t}}var A=null;function br(r){if(T.useDeprecatedSynchronousErrorHandling){var e=!A;if(e&&(A={errorThrown:!1,error:null}),r(),e){var t=A,n=t.errorThrown,o=t.error;if(A=null,n)throw o}}else r()}function xr(r){T.useDeprecatedSynchronousErrorHandling&&A&&(A.errorThrown=!0,A.error=r)}var g=function(r){Er(e,r);function e(t){var n=r.call(this)||this;return n.isStopped=!1,t?(n.destination=t,H(t)&&t.add(n)):n.destination=Br,n}return e.create=function(t,n,o){return new C(t,n,o)},e.prototype.next=function(t){this.isStopped?G(yr(t),this):this._next(t)},e.prototype.error=function(t){this.isStopped?G(vr(t),this):(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped?G(mr,this):(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,r.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(L);var Cr=Function.prototype.bind;function k(r,e){return Cr.call(r,e)}var Fr=function(){function r(e){this.partialObserver=e}return r.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(n){D(n)}},r.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(n){D(n)}else D(e)},r.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(t){D(t)}},r}(),C=function(r){Er(e,r);function e(t,n,o){var i=r.call(this)||this,u;if(y(t)||!t)u={next:t??void 0,error:n??void 0,complete:o??void 0};else{var s;i&&T.useDeprecatedNextContext?(s=Object.create(t),s.unsubscribe=function(){return i.unsubscribe()},u={next:t.next&&k(t.next,s),error:t.error&&k(t.error,s),complete:t.complete&&k(t.complete,s)}):u=t}return i.destination=new Fr(u),i}return e}(g);function D(r){T.useDeprecatedSynchronousErrorHandling?xr(r):hr(r)}function qr(r){throw r}function G(r,e){var t=T.onStoppedNotification;t&&j.setTimeout(function(){return t(r,e)})}var Br={closed:!0,next:M,error:qr,complete:M};function Tr(r,e,t,n,o){return new Nr(r,e,t,n,o)}var Nr=function(r){Ir(e,r);function e(t,n,o,i,u,s){var a=r.call(this,t)||this;return a.onFinalize=u,a.shouldUnsubscribe=s,a._next=n?function(h){try{n(h)}catch(b){t.error(b)}}:r.prototype._next,a._error=i?function(h){try{i(h)}catch(b){t.error(b)}finally{this.unsubscribe()}}:r.prototype._error,a._complete=o?function(){try{o()}catch(h){t.error(h)}finally{this.unsubscribe()}}:r.prototype._complete,a}return e.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;r.prototype.unsubscribe.call(this),!n&&((t=this.onFinalize)===null||t===void 0||t.call(this))}},e}(g);function wr(r,e){return ur(function(t,n){var o=0;t.subscribe(Tr(n,function(i){n.next(r.call(e,i,o++))}))})}var Sr=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function Ar(r){return r}function Pr(r){return r.length===0?Ar:r.length===1?r[0]:function(t){return r.reduce(function(n,o){return o(n)},t)}}var Rr=function(){function r(e){e&&(this._subscribe=e)}return r.prototype.lift=function(e){var t=new r;return t.source=this,t.operator=e,t},r.prototype.subscribe=function(e,t,n){var o=this,i=Xr(e)?e:new C(e,t,n);return br(function(){var u=o,s=u.operator,a=u.source;i.add(s?s.call(i,a):a?o._subscribe(i):o._trySubscribe(i))}),i},r.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},r.prototype.forEach=function(e,t){var n=this;return t=jr(t),new t(function(o,i){var u=new C({next:function(s){try{e(s)}catch(a){i(a),u.unsubscribe()}},error:i,complete:o});n.subscribe(u)})},r.prototype._subscribe=function(e){var t;return(t=this.source)===null||t===void 0?void 0:t.subscribe(e)},r.prototype[Sr]=function(){return this},r.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Pr(e)(this)},r.prototype.toPromise=function(e){var t=this;return e=jr(e),new e(function(n,o){var i;t.subscribe(function(u){return i=u},function(u){return o(u)},function(){return n(i)})})},r.create=function(e){return new r(e)},r}();function jr(r){var e;return(e=r??T.Promise)!==null&&e!==void 0?e:Promise}function Mr(r){return r&&y(r.next)&&y(r.error)&&y(r.complete)}function Xr(r){return r&&r instanceof g||Mr(r)&&H(r)}function F(r){switch(r.responseType){case"json":{if("response"in r)return r.response;var e=r;return JSON.parse(e.responseText)}case"document":return r.responseXML;case"text":default:{if("response"in r)return r.response;var e=r;return e.responseText}}}var _=function(){function r(e,t,n,o){o===void 0&&(o="download_load"),this.originalEvent=e,this.xhr=t,this.request=n,this.type=o;var i=t.status,u=t.responseType;this.status=i??0,this.responseType=u??"";var s=t.getAllResponseHeaders();this.responseHeaders=s?s.split(`
`).reduce(function(b,d){var m=d.indexOf(": ");return b[d.slice(0,m)]=d.slice(m+2),b},{}):{},this.response=F(t);var a=e.loaded,h=e.total;this.loaded=a,this.total=h}return r}();var R=O(function(r){return function(t,n,o){this.message=t,this.name="AjaxError",this.xhr=n,this.request=o,this.status=n.status,this.responseType=n.responseType;var i;try{i=F(n)}catch{i=n.responseText}this.response=i}}),J=function(){function r(e,t){return R.call(this,"ajax timeout",e,t),this.name="AjaxTimeoutError",this}return r.prototype=Object.create(R.prototype),r}();function kr(r,e){return P({method:"GET",url:r,headers:e})}function Gr(r,e,t){return P({method:"POST",url:r,body:e,headers:t})}function _r(r,e){return P({method:"DELETE",url:r,headers:e})}function Jr(r,e,t){return P({method:"PUT",url:r,body:e,headers:t})}function Yr(r,e,t){return P({method:"PATCH",url:r,body:e,headers:t})}var Vr=wr(function(r){return r.response});function Wr(r,e){return Vr(P({method:"GET",url:r,headers:e}))}var P=function(){var r=function(e){var t=typeof e=="string"?{url:e}:e;return Kr(t)};return r.get=kr,r.post=Gr,r.delete=_r,r.put=Jr,r.patch=Yr,r.getJSON=Wr,r}(),zr="upload",gr="download",V="loadstart",W="progress",Or="load";function Kr(r){return new Rr(function(e){var t,n,o=Y({async:!0,crossDomain:!1,withCredentials:!1,method:"GET",timeout:0,responseType:"json"},r),i=o.queryParams,u=o.body,s=o.headers,a=o.url;if(!a)throw new TypeError("url is required");if(i){var h;if(a.includes("?")){var b=a.split("?");if(2<b.length)throw new TypeError("invalid url");h=new URLSearchParams(b[1]),new URLSearchParams(i).forEach(function(p,l){return h.set(l,p)}),a=b[0]+"?"+h}else h=new URLSearchParams(i),a=a+"?"+h}var d={};if(s)for(var m in s)s.hasOwnProperty(m)&&(d[m.toLowerCase()]=s[m]);var w=o.crossDomain;!w&&!("x-requested-with"in d)&&(d["x-requested-with"]="XMLHttpRequest");var q=o.withCredentials,v=o.xsrfCookieName,K=o.xsrfHeaderName;if((q||!w)&&v&&K){var Q=(n=(t=document?.cookie.match(new RegExp("(^|;\\s*)("+v+")=([^;]*)")))===null||t===void 0?void 0:t.pop())!==null&&n!==void 0?n:"";Q&&(d[K]=Q)}var B=Qr(u,d),E=Y(Y({},o),{url:a,headers:d,body:B}),c;c=r.createXHR?r.createXHR():new XMLHttpRequest;{var f=r.progressSubscriber,Z=r.includeDownloadProgress,Ur=Z===void 0?!1:Z,$=r.includeUploadProgress,Lr=$===void 0?!1:$,rr=function(p,l){c.addEventListener(p,function(){var x,S=l();(x=f?.error)===null||x===void 0||x.call(f,S),e.error(S)})};rr("timeout",function(){return new J(c,E)}),rr("abort",function(){return new R("aborted",c,E)});var er=function(p,l){return new _(l,c,E,p+"_"+l.type)},tr=function(p,l,x){p.addEventListener(l,function(S){e.next(er(x,S))})};Lr&&[V,W,Or].forEach(function(p){return tr(c.upload,p,zr)}),f&&[V,W].forEach(function(p){return c.upload.addEventListener(p,function(l){var x;return(x=f?.next)===null||x===void 0?void 0:x.call(f,l)})}),Ur&&[V,W].forEach(function(p){return tr(c,p,gr)});var nr=function(p){var l="ajax error"+(p?" "+p:"");e.error(new R(l,c,E))};c.addEventListener("error",function(p){var l;(l=f?.error)===null||l===void 0||l.call(f,p),nr()}),c.addEventListener(Or,function(p){var l,x,S=c.status;if(S<400){(l=f?.complete)===null||l===void 0||l.call(f);var ar=void 0;try{ar=er(gr,p)}catch(Hr){e.error(Hr);return}e.next(ar),e.complete()}else(x=f?.error)===null||x===void 0||x.call(f,p),nr(S)})}var or=E.user,ir=E.method,I=E.async;or?c.open(ir,a,I,or,E.password):c.open(ir,a,I),I&&(c.timeout=E.timeout,c.responseType=E.responseType),"withCredentials"in c&&(c.withCredentials=E.withCredentials);for(var m in d)d.hasOwnProperty(m)&&c.setRequestHeader(m,d[m]);return B?c.send(B):c.send(),function(){c&&c.readyState!==4&&c.abort()}})}function Qr(r,e){var t;if(!r||typeof r=="string"||ne(r)||oe(r)||$r(r)||re(r)||ee(r)||ie(r))return r;if(te(r))return r.buffer;if(typeof r=="object")return e["content-type"]=(t=e["content-type"])!==null&&t!==void 0?t:"application/json;charset=utf-8",JSON.stringify(r);throw new TypeError("Unknown body type")}var Zr=Object.prototype.toString;function z(r,e){return Zr.call(r)==="[object "+e+"]"}function $r(r){return z(r,"ArrayBuffer")}function re(r){return z(r,"File")}function ee(r){return z(r,"Blob")}function te(r){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView(r)}function ne(r){return typeof FormData<"u"&&r instanceof FormData}function oe(r){return typeof URLSearchParams<"u"&&r instanceof URLSearchParams}function ie(r){return typeof ReadableStream<"u"&&r instanceof ReadableStream}export{R as AjaxError,_ as AjaxResponse,J as AjaxTimeoutError,P as ajax};